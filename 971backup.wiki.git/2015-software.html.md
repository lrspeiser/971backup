
  <div class="content">
    <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even"><h2><span style="font-size: 1.385em; line-height: 1.538em;">Source Code</span></h2><div>The 2015 robot code is available for current team members to access and create.  See the robot code notes below for details on how to do this.</div><div>Here is a snapshot of our <a href="../releases/src/2015_code.tar.gz">robot source code as of the end of the 2015 season</a>. </div><h2>Robot Code</h2><p>We use the git source code control system for the robot code and gerrit for code review.  You can browse the git code repository by going to <a href="https://software.frc971.org/gerrit">https://software.frc971.org/gerrit</a> and using your team svn account credentials.  <span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;">Log in to <a href="https://software.frc971.org/gerrit">gerrit</a> and add your name and email address to your account.  Then, have Austin or Brian add you to the '971 Software Developers' group.  Ask one of them to do this at a team meeting or email them.  If you don't see the <a href="https://software.frc971.org/gerrit">971-Robot-Code project on gerrit</a>, then you have not been added to the '971 Software Developers' group.</span></p><h4>Terminology</h4><p>Here's a list of some basic terminology related to the code which is helpful for gaining a basic understanding.</p><ul><li>commit (git) = A snapshot of all of the source code with an author, commit message, data, and some other metadata.<ul><li>Commits are commonly refererred to by their SHA1 hash, which is unique for each. These look like 4a644e44e66ec7af982d145cdc861338d02de462 (complete) or 4a644e4 (abbreviated; any unique prefix works most places that want a commit ID).</li></ul></li><li>repository (git) = A folder with git commits and branches, and possibly a "currently checked out" copy of the code.<ul><li>This "currently checked out" version of the code is called a "working tree".</li><li>One unique part of git is that the repository on each person's computer that they work from is </li></ul></li><li>branch (git) = A "sticky note" referring to a commit.<ul><li>Many of the git tools default to your "currently checked out" branch. This means they do things like update it when you make new commits.</li><li>gerrit:master is the branch we generally work off of.</li><li>Each repository has its own set of branches, possibly with overlapping names, so in order to uniquely identify a branch you have to identify the repository it's in too. gerrit/master and gerrit:master are two common ways to do that.</li><li>Branches under the gerrit:/unreviewed/{username}/ namespace are "scratch" branches by each user that have not necessarily been reviewed or anything. These are useful for sharing work-in-progress code.</li></ul></li><li>patch/diff = The differences between two sets of files.<ul><li>This is generally between two commits, often different patch sets of the same change.</li></ul></li><li>change (Gerrit) = A single logical modification to the code. This will eventually end up as a single commit in the git history.<ul><li>A change has one or more patch sets (see below).</li><li>Each change has an ID, which shows up in the commit message for each patch set and looks like I8ee4ac19705aeba179124c44f9b53d53b450ca49.</li><li>They also have a number, which increases by 1 for each new one (like 336).</li><li>Accessible with URLs like <a href="https:/software.frc971.org/gerrit/#/c/336/">https://software.frc971.org/gerrit/#/c/336/</a>.</li></ul></li><li>patch set (Gerrit) = A git commit (see above) representing a specific version of a change (see above).<ul><li>Each patch set for a single change is a whole new version; they do not build on top of each other.</li><li>The change ID needs to be in the message of each commit because this is how Gerrit knows that they are part of the same change.</li><li>Each one has a number which starts at 1.</li><li>You can access a specific one with a URL like <a href="https://software.frc971.org/gerrit/#/c/336/8">https://software.frc971.org/gerrit/#/c/336/8</a>. The version without the last number goes to the latest one.</li></ul></li></ul><p><strong>Late breaking news on the build system.</strong>  I don't know how this works with all of the material below, but I do know that it is important.</p><p style="padding-left: 30px;"><strong>2015-11-01: Building code with Bazel + Jessie - From Brian</strong></p><div style="color: #222222; font-family: arial, sans-serif; font-size: 12.8px; line-height: normal; padding-left: 60px;">We've got all of the code building with Bazel on Debian Jessie now. We're planning to migrate away from Gyp on Wheezy soon. The <a style="color: #1155cc;" href="https://software.frc971.org/gerrit/gitweb?p=971-Robot-Code.git;a=blob_plain;f=README.md;hb=HEAD" target="_blank" rel="noopener">README.md in the git repository</a> has directions for setting up a computer <em>(to download the 971 team software, build/compile it, and download it to a robot - Michael)</em>. I would like to get everybody migrated off of Gyp soon so we can remove it and stop having to worry about updating two sets of build system files.</div><div style="color: #222222; font-family: arial, sans-serif; font-size: 12.8px; line-height: normal; padding-left: 60px;">Some context for anybody who doesn't know already: we've been using <a style="color: #1155cc;" href="https://gyp.gsrc.io/" target="_blank" rel="noopener">Gyp</a> for couple of years because it was the best build system we could find. However, since then, Google has released their internal build tool (called <a style="color: #1155cc;" href="http://bazel.io/" target="_blank" rel="noopener">Bazel</a>) which is nicer in many ways.</div><div style="color: #222222; font-family: arial, sans-serif; font-size: 12.8px; line-height: normal; padding-left: 60px;">We're migrating build systems and operating system versions at the same time because it's easier to only have two supported combinations vs four.</div><div style="color: #222222; font-family: arial, sans-serif; font-size: 12.8px; line-height: normal; padding-left: 60px;">The Bazel infrastructure doesn't currently support all of the configurations the Gyp one does, which I'm working on. I want to finish that before getting rid of the Gyp stuff. Austin has successfully used Bazel to download code to a robot though.</div><div style="color: #222222; font-family: arial, sans-serif; font-size: 12.8px; line-height: normal; padding-left: 60px;">Upgrading a Debian machine is generally pretty easy, and they have <a style="color: #1155cc;" href="https://www.debian.org/releases/stable/amd64/release-notes/ch-upgrading.en.html" target="_blank" rel="noopener">good instructions</a>. Some people prefer reinstalling from scratch too.</div><div style="color: #222222; font-family: arial, sans-serif; font-size: 12.8px; line-height: normal; padding-left: 60px;">I recently created <a style="color: #1155cc;" href="https://software.frc971.org/gerrit/#/admin/projects/bazel,branches" target="_blank" rel="noopener">a bazel mirror on our Gerrit</a> to keep track of which version we're using. We might do some reviews there, but my release process is mostly picking a version and then cherry-picking/reverting a few commits so it works.</div><div style="color: #222222; font-family: arial, sans-serif; font-size: 12.8px; line-height: normal; padding-left: 60px;">Feel free to contact me with any questions,</div><div style="color: #222222; font-family: arial, sans-serif; font-size: 12.8px; line-height: normal; padding-left: 60px;">Brian Silverman</div><div style="color: #222222; font-size: 12.8px; line-height: normal; padding-left: 30px;"><strong>2015-11-01: Follow on to Austin's 2015-10-28 message - From Phil Schrader</strong></div><div style="padding-left: 60px;"><div><div><div>I've updated the Vagrantfile to install the packages (including bazel) that Austin's mentioned.</div>Find it here: <a style="font-size: 13.008px; line-height: 1.538em;" href="https://svn.frc971.org/svn/frc971/2016/trunk/src/vagrant_dev_vm" target="_blank" rel="noopener">https://svn.frc971.org/svn/frc971/2016/trunk/src/vagrant_dev_vm</a><br /><br /></div>If anyone has a chance, to try it out, please let me know!<br /><br /></div>I have not yet tried building robot code, but I should get around to that tonight or tomorrow.</div><div style="color: #222222; font-size: 12.8px; line-height: normal; padding-left: 30px;"><strong> </strong></div><div style="color: #222222; font-size: 12.8px; line-height: normal; padding-left: 30px;"><strong>2015-10-28: Building on a vagrant machine notes - From Austin</strong></div><div style="color: #222222; font-size: 12.8px; line-height: normal; padding-left: 60px;"><div style="font-size: 12.8px;">You need to install openjdk8 (I used Peloton's packages) and bazel from somewhere.</div><div style="font-size: 12.8px;">Then, you need to add the following to /etc/apt/sources.list.d/llvm-3.6.list</div><div style="font-size: 12.8px;">$ cat /etc/apt/sources.list.d/llvm-3.6.list </div><div style="font-size: 12.8px; padding-left: 30px;"># llvm-3.6</div><div style="font-size: 12.8px; padding-left: 30px;">deb  http://llvm.org/apt/jessie/ llvm-toolchain-jessie-3.6 main</div><div style="font-size: 12.8px; padding-left: 30px;">deb-src  http://llvm.org/apt/jessie/ llvm-toolchain-jessie-3.6 main</div><div style="font-size: 12.8px;">Then, install</div><div style="font-size: 12.8px;">sudo apt-get install git clang-3.6 ruby clang-format-3.5</div><div style="font-size: 12.8px;">  <em>(Brian added a comment on the packages: You also need python (and maybe python3) (I know python is necessary for downloading) unless something else drags that in already)</em></div><div style="font-size: 12.8px;"><em> </em></div><div style="font-size: 12.8px;">You should then be ready to check out the repo and build.</div></div><p><strong><span style="line-height: 1.538em;">Ben Fredrickson short cheat sheet of commands is:</span></strong></p><p style="padding-left: 60px;">&lt;text&gt; means you should type something specific here</p><p style="padding-left: 60px;">Get the code on a new computer:<br /><em>git clone https://&lt;username&gt;@<a href="https://software.frc971.org/gerrit/971-Robot-Code" target="_blank" rel="noopener">software.frc971.org/gerrit/971-Robot-Code</a></em></p><p style="padding-left: 60px;">If you get an "error: server certificate verification failed. CAfile: /etc/ssl/certs/ca-certificates.crt CRLfile: none while accessing https://&lt;username&gt;@software.frc971.org/gerrit/971-Robot-Code/info/refs" error, <a href="http://askubuntu.com/questions/243210/why-do-i-get-this-warning-from-gnome-keyring-in-xubuntu">turn off GNOME Keyring control</a> with<br />    <em>unset GNOME_KEYRING_CONTROL<br /></em>You can put this in your ~/.bashrc file if you want to. </p><p style="padding-left: 60px;">If you get "error: server certificate verification failed. CAfile: /etc/ssl/certs/ca-certificates.crt CRLfile: none while accessing https://michael@software.frc971.org/gerrit/971-Robot-Code/info/refs" error, you can <a href="http://stackoverflow.com/questions/21181231/server-certificate-verification-failed-cafile-etc-ssl-certs-ca-certificates-c">turn off SLL certificate verification for GIT</a> by using<br />     <em>export GIT_SSL_NO_VERIFY=1<br /></em>This can be put in ~/.bashrc if you want. </p><p style="padding-left: 60px;">Before making any changes in the code, make new branch to work on:<br /><em>git checkout -b &lt;username&gt;/&lt;project title&gt;<br /></em>The project title can be anything you want.  It is local to your copy of the git project. </p><p style="padding-left: 60px;">Add your new and changed files:<br /><em>git add &lt;list of file names&gt;</em></p><p style="padding-left: 60px;">Commit changes locally:<br /><em>git commit -m "&lt;project title&gt;: &lt;description&gt;"</em></p><p style="padding-left: 60px;">Push your changes to the server for backup and sharing:<br /><em>git push origin HEAD:unreviewed/&lt;username&gt;/&lt;project title&gt;</em></p><p style="padding-left: 60px;">To get these changes from the server to work on, <br /><em>git fetch origin unreviewed/<em style="font-size: 13.0080003738403px; line-height: 20.0063037872314px;">&lt;username&gt;/&lt;project title&gt;<br /></em></em><em style="font-size: 13.0080003738403px; line-height: 1.538em;">git co FETCH_HEAD<br /></em><em style="font-size: 13.0080003738403px; line-height: 1.538em;">git checkout -b new_branch_name</em><em style="font-size: 13.0080003738403px; line-height: 1.538em;"><em style="font-size: 13.0080003738403px; line-height: 20.0063037872314px;"> # where new_branch_name is whatever local name you want to give this branch.</em></em></p><h4 style="color: #222222; font-family: arial, sans-serif; font-size: 12.8px; line-height: normal; padding-left: 60px;"><span style="color: #353535; font-family: monospace;"><span style="font-size: 12px; white-space: pre-wrap;"><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; white-space: normal;">Making a code review:</span></span></span></h4><p style="padding-left: 60px;">Make sure your master is up to date and you are on your branch.<em> </em></p><p style="padding-left: 60px;"><em>git co master</em><br /><em>git pull origin master</em><br /><em>git co -</em></p><p style="padding-left: 60px;">Rebase all your changes onto master:<br /><em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">git rebase -i master<br /></span></em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">Here you should squash all your commits into a single commit for review. In the menu that pops up change all the commit line to "squash" except the first line which should be left as "pick".</span></p><p style="padding-left: 60px;">Now push your commit  for review:<br /><em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">git push origin HEAD:refs/for/master</span></em></p><p style="padding-left: 60px;"><span style="font-size: 13.0080003738403px; line-height: 1.538em;">If this works you are done.</span></p><p style="padding-left: 60px;"><span style="font-size: 13.0080003738403px; line-height: 1.538em;">If the following command is in the error:<br /></span><em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">gitdir=$(git rev-parse --git-dir); scp -p -P 29418 &lt;username&gt;@software.frc971.org:hooks/commit-msg ${gitdir}/hooks/<br /></span></em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">you can use it if the network you are on will allow port 29418 access to the school.  If it does not work, then run this one instead:</span><em><br />gitdir=$(git rev-parse --git-dir) &amp;&amp; curl --insecure -u &lt;username&gt; -o ${gitdir}/hooks/commit-msg https://software.frc971.org/gerrit/tools/hooks/commit-msg &amp;&amp; chmod +x ${gitdir}/hooks/commit-msg<br /></em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">The first one works for anybody who has a gerrit account and the scp part of the command connects to the gerrit ssh server on port 29418.  Port 29418 is not available on some corporate networks and the NASA guest network so use the second option with https for those networks.  Jack opened port 29418 for the team to use to on February 7, 2015.<br /><span style="font-size: 13.0080003738403px; line-height: 1.538em;">Then run:</span><br /></span><em style="font-size: 13.0080003738403px; line-height: 1.538em;"><span style="font-size: 13.0080003738403px; line-height: 1.538em;">git commit --amend<br /></span></em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">And try the push again:<br /></span><em style="font-size: 13.0080003738403px; line-height: 1.538em;"><span style="font-size: 13.0080003738403px; line-height: 1.538em;">git push origin HEAD:refs/for/master</span></em></p><p style="padding-left: 60px;">Adding changes to existing code review:  (TODO this part is incomplete. git rebase master again?)<br /><em style="font-size: 13.0080003738403px; line-height: 1.538em;">git checkout &lt;your branch that is in review&gt;<br /></em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">Make your changes.<br /></span><em style="font-size: 13.0080003738403px; line-height: 1.538em;">git add &lt;files&gt;<br /></em><em style="font-size: 13.0080003738403px; line-height: 1.538em;">git commit --amend<br /></em><em style="font-size: 13.0080003738403px; line-height: 20.0063037872314px;"><span style="font-size: 13.0080003738403px; line-height: 1.538em;">git push origin HEAD:refs/for/master</span></em><em style="font-size: 13.0080003738403px; line-height: 1.538em;"> </em></p><p style="padding-left: 60px;">Brian gave me the following command as I was trying to change code on the robot and needed to do a git update.<br /><span style="font-size: 13.0080003738403px; line-height: 1.538em;">   </span><em style="font-size: 13.0080003738403px; line-height: 1.538em;">`git add` </em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">any changes you want to keep, then</span><em style="font-size: 13.0080003738403px; line-height: 1.538em;"> `git stash --keep-index`</em><span style="font-size: 13.0080003738403px; line-height: 1.538em;"> </span></p><p style="padding-left: 60px;"><strong>Checking out the latest code</strong></p><p style="padding-left: 60px;">Ask Brian or Austin what code you should be using.  They will give you a link like <br /> <a style="color: #0065cc; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;" href="https://software.frc971.org/gerrit/#/c/336">https://software.frc971.org/gerrit/#/c/336</a><span style="font-size: 13.0080003738403px; line-height: 1.538em;"> <br />Browse to that link and click on the "Download" tab in the upper right hand corner of the page.  Then copy the downlaod checkout command by clicking on the copy to clipboard icon on the right.  Paste that into your linux terminal.  This will "fetch" the version you want and checkout the code. </span></p><p style="padding-left: 60px;"><span style="font-size: 13.0080003738403px; line-height: 1.538em;">The outstanding changes can be <a href="https://software.frc971.org/gerrit/#/q/status:open">viewed on Gerrit here</a>.  </span></p><p style="padding-left: 60px;"><strong>Building the code</strong></p><p style="padding-left: 60px;">From the top level, run build.sh to compile the code for your laptop running <em>amd64</em> and the roboRIO running <em>arm</em>.<br /><em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">  frc971/prime/build.sh</span></em><span style="font-size: 13.0080003738403px; line-height: 1.538em;"> </span></p><p style="padding-left: 60px;"><strong><span style="font-size: 13.0080003738403px; line-height: 1.538em;">Running the code on the robot</span></strong></p><p style="padding-left: 60px;">Parker and Michael suspect that you run <br /><em>  frc971/prime/build.sh deploy</em><br />to copy the code to the robot.  We think there might be some options to choose which robot to compile and download code to.  Once the code is deployed, the robot <span style="font-size: 12.8000001907349px; line-height: normal;">will restart itself  </span><span style="font-size: 12.8000001907349px; line-height: normal; font-family: inherit; color: #222222;">If the "Robot Code" light on the driver's station turns red, reboot the roborio (that's a known issue that Brian will work on some time).</span></p><p style="padding-left: 60px;"><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;">If the code does not start up when the robot is turned on, Austin says "You need to run the </span><em><span style="color: #222222; font-family: arial, sans-serif;"><span style="font-size: 12.8000001907349px; line-height: normal;">frcEnableTBLStartupApp.sh</span></span></em></p><p style="padding-left: 60px;"><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;">script in /usr/local/frc/</span><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;">bin".  </span><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;">It will enable starting code when the robot is turned on.</span></p><p style="padding-left: 60px;"><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;">"Then copy the aos/config/robotCommand script to /home/lvuser"</span></p><p style="padding-left: 60px;"><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;">The robot code can be started by hand with: <br /> <em>ssh admin@roboRIO-9971.local PATH=$PATH:robot_code starter_exe robot_code/start_list.txt</em></span></p><p style="padding-left: 60px;"><span style="color: #222222; font-family: arial, sans-serif;"><span style="font-size: 12.8px; line-height: normal;">To restart the robot code run:<em><br />touch /home/admin/robot_code/core </em></span></span></p><p style="padding-left: 60px;"><strong><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;">Running the code</span></strong></p><p style="padding-left: 60px;"><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;">Create a fresh log file on the robot with<br />  <em>touch ~/robot_code/binary_log_writer</em></span></p><p style="padding-left: 60px;">Use this to rebot the robot:<br /><em><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;">   shutdown -r now</span></em> </p><p style="padding-left: 60px;">Commands for <strong>looking at the robot logs</strong><br /><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;"><em>   </em></span><span style="color: #222222; font-family: arial, sans-serif;"><span style="font-size: 12.8000001907349px; line-height: normal;"><em>cd /media/sda1    # </em><span style="color: #000000; font-family: 'Lucida Grande', 'Lucida Sans Unicode', sans-serif; font-size: 13.008px; line-height: 20.0063px;">Use "mount" to figure out where the external USB drive for logs is mounted.</span><em><br /></em></span></span><em style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;">   ~/robot_code/log_displayer -f -l DEBUG -n fridge | fgrep .Position</em></p><p style="padding-left: 60px;"><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;"># actually, you probably want something from .Status .  D</span><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;">epends if you want encoder value, potetiometer value, zeroed value, or something else.  I used the following to check the elevator height zeroing.  The elevator timing belt teeth are 0.009 m apart (9 mm).  Errors in the elevator height that are multiples of this are due to the timing belt skipping.<br /></span><em style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;">   ~/robot_code/log_displayer -f -l DEBUG -n fridge | fgrep .Status</em><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;"> </span></p><p style="padding-left: 60px;"><span style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;"># Use the following to see a list of flags for the log_displayer routine.<br /></span><em style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;">~/robot_code/log_displayer --help</em></p><p style="padding-left: 60px;"><em>~/robot_code/log_displayer -f</em> <em style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;"><span style="color: #000000; font-family: 'Lucida Grande', 'Lucida Sans Unicode', sans-serif; font-size: 13.008px; font-style: normal; line-height: 20.0063px;">   # Shows the log file. <br /># log_displayer -f will show you edges on the buttons<br /># The "-f" says to follow the log file as it is being generated.  This is useful for seeing what is going on on the robot as you are view the log file output.  If the 2014 shooter is e-stopped, the output will say so repeatedly in the "-f" output.<br /></span></em><em style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;"><span style="color: #000000; font-family: 'Lucida Grande', 'Lucida Sans Unicode', sans-serif; font-size: 13.008px; font-style: normal; line-height: 20.0063px;"># If you want to see the current state of the buttons every time it gets read, then run<br /></span></em><em style="font-size: 13.008px; line-height: 1.538em;">log_displayer -f -l DEBUG -n wpilib_interface.DSReader | joystick_state</em></p><p style="padding-left: 60px;"><em style="color: #222222; font-family: arial, sans-serif; font-size: 12.8000001907349px; line-height: normal;"><span style="color: #000000; font-family: 'Lucida Grande', 'Lucida Sans Unicode', sans-serif; font-size: 13.008px; font-style: normal; line-height: 20.0063px;"># </span></em><span style="font-size: 13.008px; line-height: 20.0063px;">We use </span><a style="font-size: 13.008px; line-height: 20.0063px;" href="http://www.amazon.com/PNY-Turbo-64GB-Flash-Drive/dp/B00FDUHDAC">PNY Turbo 64GB USB 3.0 Flash Drive - P-FD64GTBOP-GE</a><span style="font-size: 13.008px; line-height: 20.0063px;"> for the log files.  They cost $20 each.</span></p><p style="padding-left: 60px;"><strong>Working with and Changing robot code</strong></p><p style="padding-left: 60px;">To change the height of the fridge after the robot deposits a stack on the platform or make some other such change.  Looking in files like <span style="font-size: 13.0080003738403px; line-height: 1.538em;">frc971/joystick_reader.cc and/or frc971/actors/score_actor.cc.  The first one passes parameters (i.e. the ending height of the elevator) to the score_actor.cc code which uses them to move the robot elevator and arm around.</span></p><p style="padding-left: 60px;"> </p><h2 style="padding-left: 30px;">Configuring a Debian Computer to Connect to the roboRIO</h2><p style="padding-left: 30px;">To be able to connect to the 2015 robot, the router must be running mdns (bonjour) also called zero-conf according to Phil.</p><p style="padding-left: 30px;">The <a href="http://wiki.sabnzbd.org/bonjour-support">Bonjour Support page</a> says to install it with <br /><em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">     sudo apt-get install avahi-daemon libavahi-compat-libdnssd1 mdns-scan</span></em></p><p style="padding-left: 30px;"><span style="font-size: 13.0080003738403px; line-height: 1.538em;"># Use mdns-scan to search the network for devices.<br /></span><em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">     mdns-scan</span></em></p><p style="padding-left: 30px;"><span style="font-size: 13.0080003738403px; line-height: 1.538em;"># Use ssh to connect to the admin user on the robot.  The password is blank.<br />   <em>  ssh admin@roboRIO-9971.local</em></span></p><p style="padding-left: 30px;"><span style="font-size: 13.0080003738403px; line-height: 1.538em;"># To configure the computer so that the wireless network is the default network, add the line "never-default=true" to the IPV4 section of the file<br /></span><em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">   /etc/NetworkManager/system-connections/Wired\ connection\ 1</span></em></p><p style="padding-left: 30px;">Restart the network with<br /><em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">    /etc/init.d/network-manager restart</span></em></p><p style="padding-left: 30px;">This will put the 10.0.0.10 entry at the bottom of the resolv.conf file:<br /><em><span style="font-size: 13.0080003738403px; line-height: 1.538em;">     cat /etc/resolv.conf</span></em></p><p style="padding-left: 30px;"><span style="color: #0000ff;"># Generated by NetworkManager</span><br /><span style="color: #0000ff;"><span style="font-size: 13.0080003738403px; line-height: 1.538em;">nameserver 172.20.253.2<br /></span><span style="font-size: 13.0080003738403px; line-height: 1.538em;">nameserver 172.20.253.6<br /></span><span style="font-size: 13.0080003738403px; line-height: 1.538em;">nameserver 10.0.0.10</span></span></p><p style="padding-left: 30px;"><span style="font-size: 13.0080003738403px; line-height: 1.538em;">I found this approach described in the </span><a href="http://askubuntu.com/questions/194069/setting-default-ubuntu-eth-port">Setting Default Ubuntu eth port</a> post.</p><p style="padding-left: 30px;">In a pinch, the default route can be set by hand.  Check the default route with<br />    <em>ip route default</em></p><p style="padding-left: 30px;">    <span style="color: #000080;"><strong>default</strong> via 172.20.252.1 dev wlan0  proto static </span><br /><span style="color: #000080;"><span style="line-height: 1.538em;">    10.0.0.0/24 dev eth0  proto kernel  scope link  src 10.0.0.22 <br /></span><span style="line-height: 1.538em;">    172.20.0.0/16 dev wlan0  proto kernel  scope link  src 172.20.101.20 </span></span><span style="line-height: 1.538em;"> </span></p><p style="padding-left: 30px;"><span style="line-height: 1.538em;">Change the default route by deleting it and then remaking it.</span></p><p style="padding-left: 30px;">     <em>ip route del default</em><br /><em><span style="line-height: 1.538em;">     ip route add default via 172.20.252.1</span></em></p><p style="padding-left: 30px;">Use the following command to set up the eth0 network:<br />sudo /sbin/ifconfig ethp 10.89.71.20.20 netmask 255.0.0.0</p><p style="padding-left: 30px;"><span style="font-size: 13.008px; line-height: 1.538em;">To let Brian login to a laptop that is behind a firewall, run<br /></span><em>ssh -R 2222:localhost:22 michael@software.frc971.org -f -N</em><br />This will start a connection that will stay active as long as the network stays up.  Brian can then login to software.frc971.org and connect to his "brian" account on the laptop behind the firewall with:<br /><em><span style="font-size: 13.008px; line-height: 1.538em;">ssh -p 2222 brian@localhost</span></em></p><p style="padding-left: 30px;"> </p><h2 style="padding-left: 30px;">Configuring the Driver Station and Linksys Router</h2><p style="padding-left: 30px;">It appears that there needs to be a DHCP server running for the networking to work.  Parker and Michael were able to do this on 3/23/15 by using the National Instruments Bridge Configuration Utility and setting the SSID to 9971 and the password to Axxxxx15.  We set the router to have the same settings using AES only and Wireless N only.  The driver station was set to use DHCP too.</p><h2 style="padding-left: 30px;">General Notes</h2><div style="padding-left: 30px;">The notes from here to the bottom of the page are from the 2014 season.  They will be updated for the 2015 season after I install the FRC software.</div><div style="padding-left: 30px;"><span style="font-size: 13.0080003738403px; line-height: 1.538em;">The first few times that I installed FRC software on team computes, I installed the NI software and the NI and WPI lib update as described in the second set of directions below.  On Sept 13, 2014, I read in the page that </span></div><div style="padding-left: 30px;"><ul><li><span style="line-height: 1.538em;">The </span><a style="line-height: 1.538em;" href="http://wpilib.screenstepslive.com/s/3120/m/8559/l/89639?data-resolve-url=true&amp;data-manual-id=8559">Installing the 2014 FRC NI Update (for ALL TEAMS)</a><span style="line-height: 1.538em;"> page explains that all that is needed is the NI Update.  We don't have to install anything else to program the robot in C++, run the driver station, flash the cRIO, or run the FRC Bridge configuration tool.  </span><span style="line-height: 20.0063037872314px;">I installed the NI "</span><a style="line-height: 20.0063037872314px;" href="https://decibel.ni.com/content/docs/DOC-34731">FRC 2014 Update Suite, Download Only</a><span style="line-height: 20.0063037872314px;">" only from </span><a style="line-height: 20.0063037872314px;" href="http://ni.com/frc" target="_blank" rel="noopener">http://ni.com/frc</a><span style="line-height: 20.0063037872314px;">. Installed it on a Windows 7 machine and it worked fine.  Use 00303x87M bkwds. </span></li><li><div class="description" style="font-family: Helvetica, Arial, sans-serif; font-size: 13px; line-height: 17.9200000762939px;"><p style="margin-top: 0px;">This year the NI updates have been reconfigured into a single standalone installer. This means that the FRC Driver Station, cRIO Imaging Tool and other utilities such as the Camera Configuration Tool will all be bundled into a single installer which will <span style="color: #ff0000;"><strong>not require</strong></span><strong> any components from the DVD</strong>. The LabVIEW update is also included in this installer and will install if a LabVIEW installation is detected. <strong>To use the DS and Imaging tool all teams must install the 2014 NI Update.</strong></p></div></li><li>The <a href="http://wpilib.screenstepslive.com/s/3120/m/8559/l/91405-programming-your-radio-for-home-use">Programming your radio for home use</a><span style="line-height: 1.538em;"> guide shows how to use the 2013 FRC Bridge Configuration Tool software to configure your robot's wireless bridge for use outside of FRC events. b  </span><span style="line-height: 20.0063037872314px;">It appears that they are using the 2013 tool for the 2014 season.  Somewhere it said the tool should be in the Start menu, but I did not find it there.  I did find it at C:\Program Files\National Instruments\LabVIEW 2013\project\FRC Bridge Tool\FRC Bridge Configuration Utility.exe.  When I ran it the first time, it took me to the Java download page and so I installed Java.  I made a link to this tool on the desktop.</span></li></ul></div><h2 style="padding-left: 30px;">Here are my notes from installing the FRC software before I figured out that I don't need to install the National Instruments or WPI Lib software (see my notes above).</h2><div style="padding-left: 30px;">The <a href="https://wpilib.screenstepslive.com/s/4485/m/13503/l/144981-2015-frc-software-component-overview">2015 FRC Software Component Overview</a> page directed me to the Installing the <a href="https://wpilib.screenstepslive.com/s/4485/m/13503/l/144150?data-resolve-url=true&amp;data-manual-id=13503">FRC 2015 Update Suite</a> page to find the download and install instructions for the roboRIO imaging software and driver station software.  The Installing the <a href="https://wpilib.screenstepslive.com/s/4485/m/13503/l/144150?data-resolve-url=true&amp;data-manual-id=13503">FRC 2015 Update Suite</a> page said that all we needed to install is the driver station software and utilities including the imaging tool.  It said that the FRC 2015 Update Suite includes the runtime parts needed to run the driver station software and utilities.  I installed the contents of the FRCUpdate2015.0.0.zip file on FRC 2014-4 on 2/11/15.</div><div style="padding-left: 30px;">The FRC 2015 Update Suite directed me to the <a href="https://decibel.ni.com/content/community/academic/student_competitions/frc">NI FRC page</a> for more information.</div><div style="padding-left: 30px;">Michael  </div><div style="padding-left: 30px;"><strong>2014 Notes:</strong></div><div style="padding-left: 30px;">The 2014 FIRST software consists of National Instruments Software and WPI/WindRiver software.  The National Instruments software has the driverstation program and cRIO imaging software in it.  The WPI/WindRiver software has the image FRC_2014_v52.zip image in it which is used to flash the cRIO from the NI software.  We roll our own C++ code so we don't use anything else from the WindRiver software.</div><div style="padding-left: 30px;">For the 2014 season, we did the following to set up the laptop we use to image the cRIO and the drivers station laptops.</div><div style="padding-left: 30px;"><ul><li>Uninstall the 2013 NI and WindRiver software.  The NI uninstaller is obvious but the WindRiver one is not.  The WindRiver uninstaller has the name "Maintenance Tool" and the WindRiver icon.  Some people recognize the icon.  If you can't find it, go to Start/WindRiver and use the uninstaller located there.</li><li>Install the "Vision" only half of the NI software from the DVD they sent us in the kit of parts.  I installed this software with the computer connected to the internet so that the software key would be validated.  Use the software key that is printed on the back of the envelope the software was shipped in.  I ran the update tool that came up automatically.  I installed the NI "<a href="https://decibel.ni.com/content/docs/DOC-34731">FRC 2014 Update Suite, Download Only</a>" only from <a href="http://ni.com/frc" target="_blank" rel="noopener">http://ni.com/frc</a>. Installed it on Win XP Pro machine and it worked fine.  If you only install the FRC 2014 Update Suite without installing the "Vision" software from the DVD, the cRIO imaging tool will see the cRIO and appear to be working but not get past the "Rebooting the cRIO" screen.  Again, use the software key that is printed on the back of the envelope that the software was shipped in for the update.</li><li>This <a href="http://wpilib.screenstepslive.com/s/3120/m/7913/l/156528-installing-the-frc-specific-c-components" target="_blank" rel="noopener">WPI lib page</a> has a link to the software update for WPILib Workbench  <a href="http://first.wpi.edu/FRC/c/update/Release/" target="_blank" rel="noopener">http://first.wpi.edu/FRC/c/update/Release/</a> .  The WindRiver software installs the <a href="software.frc971.org:/files/frc971/2014/crio_images/FRC_2014_v52.zip">FRC_2014_v52.zip</a> image in /WindRiver/WPILib/cRIO_Images.  I copied it to my desktop.  On Aug 23, 2014, I downloaded WorkbenchUpdate20140325rev3887.exe with March 25, 2014 date.</li><li>I set the IP address to the download computer to 10.99.97.201 and the netmask to 255.0.0.0 and turned the firewall off so that the cRIO imaging software would find the cRIO.  The imaging tool was able to find the cRIO at 10.99.97.2 with the computer at 10.9.97.201 but could not communicate enough to get set up for the download.  It did show the IP address on the cRIO so I was able to reset the computer's network to the same subnet.</li></ul><p>The 2013 FRC Bridge Configuration Tool software to configure your robot's wireless bridge for use outside of FRC events. This <a href="http://wpilib.screenstepslive.com/s/3120/m/8559/l/91405?data-resolve-url=true&amp;data-manual-id=8559">WPI page</a> talks about it and tells how to download it.  It appears that they are using the 2013 tool for the 2014 season.  It said the tool should be in the Start menu, but I did not find it there.  I did find it at C:\Program Files\National Instruments\LabVIEW 2013\project\FRC Bridge Tool\FRC Bridge Configuration Utility.exe.  When I ran it the first time, it took me to the Java download page and so I installed Java.  I made a link to this tool on the desktop.</p><p> </p></div><div style="padding-left: 30px;">Michael Schuh</div><div style="padding-left: 30px;">Feb 15, 2014</div><div style="padding-left: 30px;">Aug 23, 2014 - installed on FRC 2014-4 Nickel and updated the install notes.  Added <span style="line-height: 1.538em;">Bridge Configuration Tool notes.</span></div></div></div></div>  </div>

  
  
</div>
  </div>
</div>
  </div>
    </div>